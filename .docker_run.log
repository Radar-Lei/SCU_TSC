[0;34m[é…ç½®][0m CONFIG_FILE=/home/samuel/SCU_TSC/config/training_config.yaml
[0;34m[é…ç½®][0m max_workers(PARALLEL)=8, extend_seconds=5, warmup_steps=300
[0;34m[é…ç½®][0m GRPO_DATA_DIR=/home/samuel/SCU_TSC/data/grpo_datasets
[0;34m[é…ç½®][0m SFT_DATA_FILE=/home/samuel/SCU_TSC/data/sft_datasets/sft_dataset.json
[0;34m[é…ç½®][0m SCENARIOS_DIR=/home/samuel/SCU_TSC/sumo_simulation/environments
[0;34m[é…ç½®][0m green_offset_range=[2.0, 5.0]
[0;34m[é…ç½®][0m SFT_MODEL_DIR=/home/samuel/SCU_TSC/model/sft_model
[0;34m[é…ç½®][0m GRPO_MODEL_DIR=/home/samuel/SCU_TSC/model/grpo_model

[0;34m[æ£€æŸ¥][0m æ­£åœ¨æ£€æŸ¥å®¹å™¨å†…ä¾èµ–...
ğŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ğŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
[0;32mâœ“ æ‰€æœ‰ä¾èµ–æ£€æŸ¥é€šè¿‡[0m

[0;34m[Step 0/5][0m éªŒè¯æ•°æ®...
æ£€æµ‹åˆ°å·²æœ‰æ•°æ®ï¼Œæ‰§è¡Œæ•°æ®éªŒè¯...
/home/samuel/SCU_TSC/grpo/validate_data.py:570: UserWarning: WARNING: Unsloth should be imported before [transformers] to ensure all optimizations are applied. Your code may run slower or encounter memory issues without these optimizations.

Please restructure your imports with 'import unsloth' at the top of your file.
  __import__(package)
/usr/local/lib/python3.12/dist-packages/unsloth/__init__.py:95: UserWarning: Unsloth: `UNSLOTH_VLLM_STANDBY` is on, but requires `expandable_segments` to be off. We will remove `expandable_segments`.
  import unsloth_zoo
è¿è¡Œæ‰€æœ‰éªŒè¯...
éªŒè¯GRPOæ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets
  æ‰¾åˆ° 12 ä¸ªåœºæ™¯ç›®å½•
  åœºæ™¯ arterial4x4_99: 797 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_92: 827 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_96: 1067 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_100: 1332 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_98: 843 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_91: 995 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_93: 901 æ¡æ•°æ®
  åœºæ™¯ chengdu: 1473 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_94: 859 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_97: 835 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_95: 1051 æ¡æ•°æ®
  åœºæ™¯ arterial4x4_90: 898 æ¡æ•°æ®
éªŒè¯SFTæ•°æ®é›†: /home/samuel/SCU_TSC/data/sft_datasets/sft_dataset.json
  å…± 11878 æ¡æ•°æ®
éªŒè¯SUMOçŠ¶æ€æ–‡ä»¶ï¼ˆæŠ½æ ·10ä¸ªï¼‰
  å…±æ‰¾åˆ° 11878 ä¸ªstate_file
  æŠ½æ ·éªŒè¯ 10 ä¸ªæ–‡ä»¶
éªŒè¯é…ç½®æ–‡ä»¶: /home/samuel/SCU_TSC/config/training_config.yaml
  YAMLæ ¼å¼æ­£ç¡®
  torch: å·²å®‰è£…
  transformers: å·²å®‰è£…
ğŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ğŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
  unsloth: å·²å®‰è£…
  trl: å·²å®‰è£…
  SUMO_HOME: /usr/share/sumo
  SUMOå‘½ä»¤å¯ç”¨

âœ“ æ‰€æœ‰éªŒè¯é€šè¿‡
[0;32mâœ“ æ•°æ®éªŒè¯é€šè¿‡ (${VALIDATION_DURATION}ç§’)[0m

[0;34m[Step 1/5][0m ç”ŸæˆGRPOæ•°æ®é›†...
[0;33m[SKIP][0m æ£€æµ‹åˆ°å·²æœ‰GRPOæ•°æ®é›†ï¼Œè·³è¿‡ç”Ÿæˆ
[0;32mâœ“ Step 1/5 å®Œæˆ[0m

[0;34m[Step 2/5][0m ç”ŸæˆSFTæ•°æ®é›†...
[0;33m[SKIP][0m æ£€æµ‹åˆ°å·²æœ‰SFTæ•°æ®é›†ï¼Œè·³è¿‡ç”Ÿæˆ
[0;32mâœ“ Step 2/5 å®Œæˆ[0m

[0;34m[Step 3/5][0m SFTè®­ç»ƒ...
[0;33m[SKIP][0m æ£€æµ‹åˆ°å·²æœ‰SFTæ¨¡å‹ï¼Œè·³è¿‡è®­ç»ƒ
[0;32mâœ“ Step 3/5 å®Œæˆ[0m

[0;34m[Step 4/5][0m GRPOè®­ç»ƒ...
<frozen runpy>:128: RuntimeWarning: 'grpo.training' found in sys.modules after import of package 'grpo', but prior to execution of 'grpo.training'; this may result in unpredictable behaviour
/usr/local/lib/python3.12/dist-packages/unsloth/__init__.py:95: UserWarning: Unsloth: `UNSLOTH_VLLM_STANDBY` is on, but requires `expandable_segments` to be off. We will remove `expandable_segments`.
  import unsloth_zoo
å·²åŠ è½½ä¸­å¤®è®­ç»ƒé…ç½®: /home/samuel/SCU_TSC/config/training_config.yaml
ä½¿ç”¨training_config.yamlä¸­çš„é…ç½®
============================================================
GRPOè®­ç»ƒ
============================================================
æ¨¡å‹è·¯å¾„: /home/samuel/SCU_TSC/model/sft_model
æ•°æ®é›†è·¯å¾„: /home/samuel/SCU_TSC/data/grpo_datasets
è¾“å‡ºç›®å½•: /home/samuel/SCU_TSC/model/grpo_model
å­¦ä¹ ç‡: 5e-06
æ‰¹æ¬¡å¤§å°: 2
æ¢¯åº¦ç´¯ç§¯æ­¥æ•°: 4
ç”Ÿæˆå€™é€‰æ•°: 4
æ¸©åº¦: 0.9
KLç³»æ•°: 0.1
è®­ç»ƒè½®æ•°: 3
Formatæƒé‡: 1.0
TSCæƒé‡: 1.0
Baselineè¿½è¸ª: å¯ç”¨
  - æœ€å°ç»¿åç§»: 0.0s
  - å‹åŠ›é˜ˆå€¼: 0.0
  - å…è®¸è¦†ç›–æœ€å¤§ç»¿: False
============================================================
ğŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ğŸ¦¥ Unsloth Zoo will now patch everything to make training faster!

æ­£åœ¨åŠ è½½SFTæ¨¡å‹...
==((====))==  Unsloth 2026.1.4: Fast Qwen2 patching. Transformers: 4.57.1. vLLM: 0.1.dev1+g18d4e481d.d20260108.cu130.
   \\   /|    NVIDIA GB10. Num GPUs = 1. Max memory: 119.697 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.10.0a0+b558c986e8.nv25.11. CUDA: 12.1. CUDA Toolkit: 13.0. Triton: 3.5.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.33.post1. FA2 = True]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth 2026.1.4 patched 24 layers with 24 QKV layers, 24 O layers and 24 MLP layers.
Unsloth: Already have LoRA adapters! We shall skip this step.
The model is already on multiple devices. Skipping the move to device specified in `args`.
==((====))==  Unsloth - 2x faster free finetuning | Num GPUs used = 1
   \\   /|    Num examples = 11,878 | Num Epochs = 3 | Total steps = 17,817
O^O/ \_/ \    Batch size per device = 2 | Gradient accumulation steps = 4
\        /    Data Parallel GPUs = 1 | Total batch size (2 x 4 x 1) = 8
 "-____-"     Trainable parameters = 17,596,416 of 511,629,184 (3.44% trained)
æ­£åœ¨é…ç½®LoRA...

æ­£åœ¨åŠ è½½æ•°æ®é›†...
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_99/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_92/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_96/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_100/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_98/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_91/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_93/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/chengdu/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_94/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_97/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_95/grpo_dataset.json
æ­£åœ¨åŠ è½½æ•°æ®é›†: /home/samuel/SCU_TSC/data/grpo_datasets/arterial4x4_90/grpo_dataset.json
æ€»å…±åŠ è½½äº† 11878 æ¡GRPOæ•°æ®
è½¬æ¢ä¸ºGRPOæ ¼å¼: 11878 æ¡æ•°æ®
åŠ è½½äº† 11878 æ¡è®­ç»ƒæ•°æ®

æ­£åœ¨é…ç½®rewardå‡½æ•°é“¾...
è­¦å‘Š: Baselineé¢„è®¡ç®—å¤±è´¥: the JSON object must be str, bytes or bytearray, not list
ç¦ç”¨baselineè¿½è¸ª
æ­£åœ¨é…ç½®GRPOè®­ç»ƒå‚æ•°...

æ­£åœ¨åˆ›å»ºGRPOè®­ç»ƒå™¨...

å¼€å§‹è®­ç»ƒ...
  0%|          | 0/17817 [00:00<?, ?it/s]Unsloth: Will smartly offload gradients to save VRAM!

[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] outputs[0]: {"extend": "yes"}
  0%|          | 1/17817 [00:32<162:52:49, 32.91s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "no"}
  0%|          | 2/17817 [00:34<71:04:32, 14.36s/it] Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "no"}
  0%|          | 3/17817 [00:35<41:39:35,  8.42s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "yes"}
  0%|          | 4/17817 [00:37<28:03:32,  5.67s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] outputs[0]: {"extend": "no"}
  0%|          | 5/17817 [00:38<20:28:26,  4.14s/it]                                                      0%|          | 5/17817 [00:38<20:28:26,  4.14s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================

{'loss': 0.0217, 'grad_norm': 0.1811235249042511, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 20760.0, 'completions/mean_length': 7.0, 'completions/min_length': 7.0, 'completions/max_length': 7.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 7.0, 'completions/min_terminated_length': 7.0, 'completions/max_terminated_length': 7.0, 'rewards/reward_fn/mean': 1.0, 'rewards/reward_fn/std': 0.0, 'reward': 1.0, 'reward_std': 0.0, 'frac_reward_zero_std': 1.0, 'completion_length': 7.0, 'kl': 0.21681666746735573, 'epoch': 0.0}

[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] outputs[0]: {"extend": "no"}
  0%|          | 6/17817 [00:39<15:47:30,  3.19s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] outputs[0]: {"extend": "yes"}
  0%|          | 7/17817 [00:41<12:47:49,  2.59s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "no"}
  0%|          | 8/17817 [00:42<10:48:45,  2.19s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "yes"}
  0%|          | 9/17817 [00:43<9:38:58,  1.95s/it] Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] outputs[0]: {"extend": "yes"}
  0%|          | 10/17817 [00:45<8:45:05,  1.77s/it]                                                      0%|          | 10/17817 [00:45<8:45:05,  1.77s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================

{'loss': 0.0161, 'grad_norm': 0.05529969185590744, 'learning_rate': 4.5e-06, 'num_tokens': 41520.0, 'completions/mean_length': 7.0, 'completions/min_length': 7.0, 'completions/max_length': 7.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 7.0, 'completions/min_terminated_length': 7.0, 'completions/max_terminated_length': 7.0, 'rewards/reward_fn/mean': 1.0, 'rewards/reward_fn/std': 0.0, 'reward': 1.0, 'reward_std': 0.0, 'frac_reward_zero_std': 1.0, 'completion_length': 7.0, 'kl': 0.160950945597142, 'epoch': 0.0}

[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "yes"}
  0%|          | 11/17817 [00:46<8:07:53,  1.64s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] outputs[0]: {"extend": "yes"}
  0%|          | 12/17817 [00:48<7:43:09,  1.56s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "no"}
  0%|          | 13/17817 [01:03<28:57:20,  5.85s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{\n  "extend": "no"\n}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{\n  "extend": "yes"\n}'}]
[DEBUG] outputs[0]: {
  "extend": "no"
}
  0%|          | 14/17817 [01:05<22:25:02,  4.53s/it]Warning: TSC reward calculation failed: SUMO reward calculation failed: the JSON object must be str, bytes or bytearray, not list
Using format reward only for 8 samples

==================================================
Reward Statistics:
  Total: 8
  Format accuracy: 100.0%
  Strict: 8, Partial: 0, Invalid: 0
  Avg format reward: 1.000
  Avg TSC reward: 0.000
  Avg final reward: 1.000
==================================================


[DEBUG] completions type: <class 'list'>
[DEBUG] completions length: 8
[DEBUG] completions[0] type: <class 'list'>
[DEBUG] completions[0] value: [{'role': 'assistant', 'content': '{"extend": "no"}'}]
[DEBUG] completions[1] type: <class 'list'>
[DEBUG] completions[1] value: [{'role': 'assistant', 'content': '{"extend": "yes"}'}]
[DEBUG] outputs[0]: {"extend": "no"}
